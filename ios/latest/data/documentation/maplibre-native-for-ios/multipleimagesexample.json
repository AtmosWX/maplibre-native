{"kind":"article","identifier":{"url":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre-Native-for-iOS\/MultipleImagesExample","interfaceLanguage":"occ"},"sections":[],"variants":[{"paths":["\/documentation\/maplibre-native-for-ios\/multipleimagesexample"],"traits":[{"interfaceLanguage":"occ"}]}],"metadata":{"roleHeading":"Article","title":"Adding Multiple Images","modules":[{"name":"MapLibre"}],"role":"article"},"abstract":[{"text":"Adding images to the map and assigning them to POI types","type":"text"}],"hierarchy":{"paths":[["doc:\/\/org.swift.MyProject\/documentation\/MapLibre"]]},"primaryContentSections":[{"content":[{"type":"aside","name":"Note","content":[{"inlineContent":[{"type":"text","text":"This example uses UIKit."}],"type":"paragraph"}],"style":"note"},{"inlineContent":[{"text":"This example uses POIs in national parks and adds them to the map with data and icons provided by the National Park Service. Both the data and the icons are in the public domain.","type":"text"}],"type":"paragraph"},{"type":"heading","text":"Preparation","level":2,"anchor":"Preparation"},{"type":"paragraph","inlineContent":[{"text":"We’ve done all the work for you and generated ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/maplibre-native.s3.eu-central-1.amazonaws.com\/ios-swift-example-app-resources\/pois-nps.mbtiles"},{"text":", which you can download directly.","type":"text"},{"text":" ","type":"text"},{"text":"You can skip the rest of this section unless you’re curious how we built the MBTiles from the source data.","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Data, Shapefile download: "},{"isActive":true,"type":"reference","identifier":"https:\/\/public-nps.opendata.arcgis.com\/datasets\/a40e2faa953b4c5cb7fe10004dc3008e_0\/"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Icons: "},{"type":"reference","identifier":"https:\/\/www.nps.gov\/subjects\/gisandmapping\/map-symbols-patterns-for-nps-maps.htm","isActive":true}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Convert the data first to GeoJSON format with "},{"isActive":true,"identifier":"https:\/\/gdal.org\/programs\/ogr2ogr.html","type":"reference"},{"text":" and then to GeoJSON format using ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/felt\/tippecanoe"},{"type":"text","text":"."}]},{"syntax":null,"type":"codeListing","code":["ogr2ogr -f GeoJSON pois.json -t_srs EPSG:4326 nps-pois.shp","tippecanoe -o pois-nps.mbtiles pois.json"]},{"inlineContent":[{"type":"text","text":"The resulting "},{"code":".mbtiles","type":"codeVoice"},{"text":" file can be hosted with a tile server such as ","type":"text"},{"identifier":"https:\/\/martin.maplibre.org\/","type":"reference","isActive":true},{"type":"text","text":" or embedded in the app bundle as a resource. Since the file is quite small in this case we will use that last option in this example. Martin comes with a "},{"identifier":"https:\/\/maplibre.org\/martin\/mbtiles-meta.html","isActive":true,"type":"reference"},{"type":"text","text":" that allows us to inspect what the MBTiles file contains from the command line."}],"type":"paragraph"},{"type":"codeListing","syntax":null,"code":["mbtiles meta-all pois-nps.mbtiles"]},{"inlineContent":[{"text":"The important thing to note is that there is a ","type":"text"},{"code":"pois","type":"codeVoice"},{"type":"text","text":" layer whose features include a "},{"type":"codeVoice","code":"POITYPE"},{"text":" attribute. While we could add icons for all kinds of ","type":"text"},{"type":"codeVoice","code":"POITYPE"},{"type":"text","text":" values included in the dataset, we will only add icons for restrooms, trailheads and viewpoints, and leave the rest as an exercise to the reader."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"The icons need to be extracted with a tool like ","type":"text"},{"type":"reference","identifier":"https:\/\/inkscape.org\/","isActive":true},{"text":" because the National Park Service includes all icons in a big vector file. This is outside the scope of this example.","type":"text"}]},{"text":"Adding Icons on Style Load","level":2,"type":"heading","anchor":"Adding-Icons-on-Style-Load"},{"inlineContent":[{"type":"text","text":"The "},{"type":"codeVoice","code":".mbtiles"},{"text":" file needs to be added to the assets of the app. When the style loads we can add a ","type":"text"},{"isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorTileSource","type":"reference"},{"text":" with as URL ","type":"text"},{"type":"codeVoice","code":"mbtiles:\/\/\\(Bundle.main.bundlePath)\/pois-nps.mbtiles\""},{"text":".","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"The images need to be added to an imageset so they can be loaded as an ","type":"text"},{"code":"UIImage","type":"codeVoice"},{"type":"text","text":" and added to the style with "},{"type":"reference","isActive":true,"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNStyle\/setImage:forName:"},{"type":"text","text":" as is shown below in the example. Note that you should set "},{"type":"reference","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorStyleLayer\/sourceLayerIdentifier","isActive":true},{"type":"text","text":" to match the layer name in the MBTiles file. Lastly a "},{"type":"reference","isActive":true,"identifier":"https:\/\/maplibre.org\/maplibre-style-spec\/expressions\/#match"},{"type":"text","text":" is used to select the correct image based on "},{"type":"codeVoice","code":"POITYPE"},{"text":" attribute present in the feature.","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["class MultipleImagesExample: UIViewController, MLNMapViewDelegate {","    var mapView: MLNMapView!","","    override func viewDidLoad() {","        super.viewDidLoad()","","        mapView = MLNMapView(frame: view.bounds, styleURL: AMERICANA_STYLE)","        mapView.autoresizingMask = [.flexibleWidth, .flexibleHeight]","        mapView.tintColor = .darkGray","","        let glacierPoint = CLLocationCoordinate2D(latitude: 37.72836462778902, longitude: -119.57352616838511)","        mapView.setCenter(glacierPoint, animated: false)","        mapView.zoomLevel = 12","","        mapView.delegate = self","        view.addSubview(mapView)","    }","","    \/\/ Wait until the style is loaded before modifying the map style.","    func mapView(_: MLNMapView, didFinishLoading style: MLNStyle) {","        let source = MLNVectorTileSource(identifier: \"pois-nps\", configurationURL: URL(string: \"mbtiles:\/\/\\(Bundle.main.bundlePath)\/pois-nps.mbtiles\")!)","","        style.addSource(source)","","        let imagesToAdd = [","            [\"nps-restrooms\", \"restrooms\"],","            [\"nps-trailhead\", \"trailhead\"],","            [\"nps-viewpoint\", \"viewpoint\"],","        ]","","        for imageInfo in imagesToAdd {","            if let imageName = imageInfo.first, let imageKey = imageInfo.last {","                if let image = UIImage(named: imageName) {","                    style.setImage(image, forName: imageKey)","                } else {","                    print(\"Failed to load \\(imageName)\")","                    return","                }","            }","        }","","        let imageLayer = MLNSymbolStyleLayer(identifier: \"npc-poi-images\", source: source)","        imageLayer.sourceLayerIdentifier = \"pois\"","        imageLayer.iconImageName = NSExpression(mglJSONObject: [","            \"match\", [\"get\", \"POITYPE\"],","            \"Restroom\", \"restrooms\",","            \"Trailhead\", \"trailhead\",","            \"Viewpoint\", \"viewpoint\",","            \"\",","        ])","","        style.addLayer(imageLayer)","    }","}"]},{"type":"paragraph","inlineContent":[{"identifier":"MultipleImagesExample.png","type":"image"}]}],"kind":"content"}],"schemaVersion":{"patch":0,"minor":3,"major":0},"references":{"MultipleImagesExample.png":{"variants":[{"traits":["2x","light"],"url":"\/images\/MultipleImagesExample@2x.png"}],"alt":null,"identifier":"MultipleImagesExample.png","type":"image"},"https://gdal.org/programs/ogr2ogr.html":{"identifier":"https:\/\/gdal.org\/programs\/ogr2ogr.html","titleInlineContent":[{"type":"codeVoice","code":"ogr2ogr"}],"title":"ogr2ogr","type":"link","url":"https:\/\/gdal.org\/programs\/ogr2ogr.html"},"https://www.nps.gov/subjects/gisandmapping/map-symbols-patterns-for-nps-maps.htm":{"title":"https:\/\/www.nps.gov\/subjects\/gisandmapping\/map-symbols-patterns-for-nps-maps.htm","titleInlineContent":[{"type":"text","text":"https:\/\/www.nps.gov\/subjects\/gisandmapping\/map-symbols-patterns-for-nps-maps.htm"}],"identifier":"https:\/\/www.nps.gov\/subjects\/gisandmapping\/map-symbols-patterns-for-nps-maps.htm","url":"https:\/\/www.nps.gov\/subjects\/gisandmapping\/map-symbols-patterns-for-nps-maps.htm","type":"link"},"https://inkscape.org/":{"identifier":"https:\/\/inkscape.org\/","titleInlineContent":[{"type":"text","text":"Inkscape"}],"title":"Inkscape","type":"link","url":"https:\/\/inkscape.org\/"},"https://martin.maplibre.org/":{"title":"Martin","titleInlineContent":[{"type":"text","text":"Martin"}],"identifier":"https:\/\/martin.maplibre.org\/","url":"https:\/\/martin.maplibre.org\/","type":"link"},"doc://org.swift.MyProject/documentation/MapLibre/MLNStyle/setImage:forName:":{"navigatorTitle":[{"text":"setImage:forName:","kind":"identifier"}],"abstract":[{"text":"Adds or overrides an image used by the style’s layers.","type":"text"}],"fragments":[{"text":"- ","kind":"text"},{"kind":"identifier","text":"setImage:forName:"}],"url":"\/documentation\/maplibre\/mlnstyle\/setimage:forname:","kind":"symbol","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNStyle\/setImage:forName:","type":"topic","role":"symbol","title":"setImage:forName:"},"doc://org.swift.MyProject/documentation/MapLibre":{"url":"\/documentation\/maplibre","abstract":[{"type":"text","text":"Powerful, free and open-source mapping toolkit with full control over data sources and styling."}],"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre","kind":"symbol","title":"MapLibre","role":"collection","type":"topic"},"doc://org.swift.MyProject/documentation/MapLibre/MLNVectorStyleLayer":{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorStyleLayer","type":"topic","title":"MLNVectorStyleLayer","kind":"symbol","fragments":[{"kind":"identifier","text":"MLNVectorStyleLayer"}],"abstract":[{"type":"reference","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorStyleLayer","isActive":true},{"type":"text","text":" is an abstract superclass for style layers whose content"},{"type":"text","text":" "},{"type":"text","text":"is defined by an "},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNShapeSource","type":"reference","isActive":true},{"type":"text","text":" or "},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNShapeSource","isActive":true,"type":"reference"},{"text":" object.","type":"text"}],"role":"symbol","url":"\/documentation\/maplibre\/mlnvectorstylelayer"},"doc://org.swift.MyProject/documentation/MapLibre/MLNStyle":{"title":"MLNStyle","role":"symbol","url":"\/documentation\/maplibre\/mlnstyle","type":"topic","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNStyle","kind":"symbol","fragments":[{"kind":"identifier","text":"MLNStyle"}],"abstract":[{"text":"The proxy object for the current map style.","type":"text"}]},"https://maplibre.org/maplibre-style-spec/expressions/#match":{"identifier":"https:\/\/maplibre.org\/maplibre-style-spec\/expressions\/#match","titleInlineContent":[{"type":"codeVoice","code":"match"},{"text":" expression","type":"text"}],"title":"match expression","type":"link","url":"https:\/\/maplibre.org\/maplibre-style-spec\/expressions\/#match"},"doc://org.swift.MyProject/documentation/MapLibre/MLNVectorStyleLayer/sourceLayerIdentifier":{"kind":"symbol","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorStyleLayer\/sourceLayerIdentifier","fragments":[{"kind":"identifier","text":"sourceLayerIdentifier"}],"url":"\/documentation\/maplibre\/mlnvectorstylelayer\/sourcelayeridentifier","abstract":[{"text":"Identifier of the layer within the source identified by the ","type":"text"},{"type":"codeVoice","code":"sourceIdentifier"},{"type":"text","text":" "},{"type":"text","text":"property from which the receiver obtains the data to style."}],"title":"sourceLayerIdentifier","type":"topic","role":"symbol"},"https://maplibre-native.s3.eu-central-1.amazonaws.com/ios-swift-example-app-resources/pois-nps.mbtiles":{"identifier":"https:\/\/maplibre-native.s3.eu-central-1.amazonaws.com\/ios-swift-example-app-resources\/pois-nps.mbtiles","titleInlineContent":[{"type":"codeVoice","code":"pois-nps.mbtiles"}],"title":"pois-nps.mbtiles","type":"link","url":"https:\/\/maplibre-native.s3.eu-central-1.amazonaws.com\/ios-swift-example-app-resources\/pois-nps.mbtiles"},"https://github.com/felt/tippecanoe":{"title":"tippecanoe","titleInlineContent":[{"type":"text","text":"tippecanoe"}],"identifier":"https:\/\/github.com\/felt\/tippecanoe","url":"https:\/\/github.com\/felt\/tippecanoe","type":"link"},"https://public-nps.opendata.arcgis.com/datasets/a40e2faa953b4c5cb7fe10004dc3008e_0/":{"identifier":"https:\/\/public-nps.opendata.arcgis.com\/datasets\/a40e2faa953b4c5cb7fe10004dc3008e_0\/","titleInlineContent":[{"type":"text","text":"https:\/\/public-nps.opendata.arcgis.com\/datasets\/a40e2faa953b4c5cb7fe10004dc3008e_0\/"}],"title":"https:\/\/public-nps.opendata.arcgis.com\/datasets\/a40e2faa953b4c5cb7fe10004dc3008e_0\/","type":"link","url":"https:\/\/public-nps.opendata.arcgis.com\/datasets\/a40e2faa953b4c5cb7fe10004dc3008e_0\/"},"https://maplibre.org/martin/mbtiles-meta.html":{"title":"mbtiles binary","titleInlineContent":[{"type":"codeVoice","code":"mbtiles"},{"type":"text","text":" binary"}],"identifier":"https:\/\/maplibre.org\/martin\/mbtiles-meta.html","url":"https:\/\/maplibre.org\/martin\/mbtiles-meta.html","type":"link"},"doc://org.swift.MyProject/documentation/MapLibre/MLNVectorTileSource":{"type":"topic","fragments":[{"text":"MLNVectorTileSource","kind":"identifier"}],"abstract":[{"isActive":true,"type":"reference","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorTileSource"},{"type":"text","text":" is a map content source that supplies tiled vector data"},{"text":" ","type":"text"},{"text":"in ","type":"text"},{"text":"Mapbox Vector Tile","type":"text"},{"type":"text","text":" format"},{"type":"text","text":" "},{"type":"text","text":"to be shown on the map. The location of and metadata about the tiles are"},{"type":"text","text":" "},{"type":"text","text":"defined either by an option dictionary or by an external file that conforms to"},{"type":"text","text":" "},{"text":"the","type":"text"},{"text":" ","type":"text"},{"text":"TileJSON specification","type":"text"},{"type":"text","text":"."},{"type":"text","text":" "},{"type":"text","text":"A vector tile source is added to an "},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNStyle","isActive":true,"type":"reference"},{"text":" object along with one or more","type":"text"},{"text":" ","type":"text"},{"identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorStyleLayer","type":"reference","isActive":true},{"type":"text","text":" objects. A vector style layer defines the appearance of"},{"text":" ","type":"text"},{"text":"any content supplied by the vector tile source.","type":"text"}],"kind":"symbol","title":"MLNVectorTileSource","role":"symbol","url":"\/documentation\/maplibre\/mlnvectortilesource","identifier":"doc:\/\/org.swift.MyProject\/documentation\/MapLibre\/MLNVectorTileSource"}}}